import{_ as I}from"./preact.module-7_OotSvk.js";import{q as f,c as Y,A as L,d as N,y as Z,$ as ee}from"./create-component-CR2aSVXZ.js";import{u as te,m as M}from"./use-mouse-down-outside-C9Ms6DBz.js";import{g as _}from"./get-current-from-ref-J2nPd355.js";import{I as ne}from"./icon-check-16-D7BaBx8-.js";import{I as oe}from"./icon-chevron-down-16-BVHs5txu.js";import{c as R}from"./create-class-name-irFPZBOU.js";import{n as k}from"./no-op-DX6rZLP_.js";import{V as w,I as A,a as V}from"./constants-ByKZPpIE.js";function re(n){const{itemIdDataAttributeName:e,menuElementRef:o,selectedId:r,setSelectedId:p}=n,h=f(function(){return Array.from(_(o).querySelectorAll(`[${e}]`)).filter(function(m){return m.hasAttribute("disabled")===!1})},[e,o]),c=f(function(m){if(m===null)return-1;const i=h().findIndex(function(a){return a.getAttribute(e)===m});if(i===-1)throw new Error("`index` is `-1`");return i},[h,e]),y=f(function(m){const i=h(),a=c(m),u=i[a],l=u.getBoundingClientRect().top,S=_(o),g=S.getBoundingClientRect().top;if(l<g){u.scrollIntoView();return}l+u.offsetHeight>g+S.offsetHeight&&u.scrollIntoView()},[c,h,o]),E=f(function(m){const i=m.key;if(i==="ArrowDown"||i==="ArrowUp"){const a=h(),u=c(r);let l;i==="ArrowDown"?l=u===-1||u===a.length-1?0:u+1:l=u===-1||u===0?a.length-1:u-1;const g=a[l].getAttribute(e);p(g),y(g)}},[h,c,e,p,r,y]);return{handleScrollableMenuItemMouseMove:f(function(m){const i=m.currentTarget.getAttribute(e);i!==r&&p(i)},[e,r,p]),handleScrollableMenuKeyDown:E}}const le="_dropdown_i81qm_1",ie="_disabled_i81qm_14",ce="_menu_i81qm_27",se="_icon_i81qm_31",ue="_placeholder_i81qm_45",de="_value_i81qm_46",ae="_hasIcon_i81qm_57",fe="_chevronIcon_i81qm_69",T={dropdown:le,disabled:ie,menu:ce,icon:se,placeholder:ue,value:de,hasIcon:ae,chevronIcon:fe};function me(n,e,o){const r=n.getBoundingClientRect(),p=n.offsetWidth,h=n.offsetHeight,c=r.left,y=r.top;e.style.minWidth=`${p}px`;const E=window.innerWidth-2*w;e.style.maxWidth=`${E}px`;const d=window.innerHeight-2*w;e.style.maxHeight=`${d}px`;const m=e.offsetWidth,i=e.offsetHeight,a=e.scrollHeight,u=parseInt(window.getComputedStyle(e).paddingTop,10),l=he(e,o),S=pe({menuWidth:m,rootLeft:c});e.style.left=`${S}px`;const g=we({menuHeight:i,rootTop:y,selectedTop:l.offsetTop});e.style.top=`${g}px`,a>i!==!1&&(e.scrollTop=ge({menuHeight:i,menuPaddingTop:u,menuScrollHeight:a,rootHeight:h,rootTop:y,selectedTop:l.offsetTop}))}function he(n,e){const o=n.querySelector(e===V?`[${A}]`:`[${A}='${e}']`);if(o===null)throw new Error("`inputElement` is `null`");const r=o.parentElement;if(r===null)throw new Error("`labelElement` is `null`");return r}function pe(n){const{menuWidth:e,rootLeft:o}=n;if(o<=w)return w;const r=window.innerWidth;return o+e>r-w?r-w-e:o}function we(n){const{menuHeight:e,rootTop:o,selectedTop:r}=n,p=window.innerHeight;if(o<=w||e===p-2*w)return w;const h=o-r,c=w,y=p-w-e;return B(h,c,y)}function ge(n){const{menuHeight:e,menuPaddingTop:o,menuScrollHeight:r,rootHeight:p,rootTop:h,selectedTop:c}=n,y=B(h,w,window.innerHeight-w-p+o/2),E=c-(y-w),d=0,m=r-e;return B(E,d,m)}function B(n,e,o){return Math.min(Math.max(n,e),o)}const De=Y(function({disabled:n=!1,icon:e,onChange:o=k,onKeyDown:r=k,onMouseDown:p=k,onValueChange:h=k,options:c,placeholder:y,propagateEscapeKeyDown:E=!0,value:d,...m},i){if(typeof e=="string"&&e.length!==1)throw new Error(`String \`icon\` must be a single character: "${e}"`);const a=L(null),u=L(null),[l,S]=N(!1),g=P(c,d);if(d!==null&&g===-1)throw new Error(`Invalid \`value\`: ${d}`);const[v,C]=N(g===-1?V:`${g}`),U=typeof c[g]>"u"?"":Ie(c[g]),{handleScrollableMenuKeyDown:O,handleScrollableMenuItemMouseMove:F}=re({itemIdDataAttributeName:A,menuElementRef:u,selectedId:v,setSelectedId:C}),$=f(function(){_(a).blur()},[]),x=f(function(){_(a).focus()},[]),W=f(function(t){const s=_(a),D=_(u);me(s,D,t)},[]),b=f(function(){S(!1),C(V)},[]),H=f(function(){if(l===!0)return;if(S(!0),d===null){W(v);return}const t=P(c,d);if(t===-1)throw new Error(`Invalid \`value\`: ${d}`);const s=`${t}`;C(s),W(s)},[l,c,v,W,d]),K=f(function(t){r(t);const s=t.key;if(s==="ArrowUp"||s==="ArrowDown"){if(t.preventDefault(),l===!1){H();return}O(t);return}if(s==="Escape"){if(t.preventDefault(),E===!1&&t.stopPropagation(),l===!0){b();return}$();return}if(s==="Enter"){if(t.preventDefault(),l===!1){H();return}if(v!==V){const D=_(u).querySelector(`[${A}='${v}']`);if(D===null)throw new Error("`selectedElement` is `null`");D.checked=!0;const q=new window.Event("change",{bubbles:!0,cancelable:!0});D.dispatchEvent(q)}b();return}if(s==="Tab"){b();return}},[O,l,r,E,v,b,H,$]),G=f(function(t){p(t),l===!1&&H()},[l,p,H]),j=f(function(t){t.stopPropagation()},[]),z=f(function(t){o(t);const s=t.currentTarget.getAttribute(A);if(s===null)throw new Error("`id` is `null`");const q=c[parseInt(s,10)].value;h(q),x(),b()},[o,h,c,b,x]),J=f(function(){x(),b()},[b,x]),Q=f(function(){l!==!1&&(b(),$())},[l,$,b]);te({onMouseDownOutside:Q,ref:a}),Z(function(){function t(){l!==!1&&(x(),b())}return window.addEventListener("scroll",t),function(){window.removeEventListener("scroll",t)}},[l,b,x]);const X=f(function(t){if(a.current=t,i!==null){if(typeof i=="function"){i(t);return}i.current=t}},[i,a]);return I("div",{...m,ref:X,class:R([T.dropdown,typeof e<"u"?T.hasIcon:null,n===!0?T.disabled:null]),onKeyDown:n===!0?void 0:K,onMouseDown:G,tabIndex:0},typeof e>"u"?null:I("div",{class:T.icon},e),d===null?I("div",{class:R([T.value,T.placeholder])},y):I("div",{class:T.value},U),I("div",{class:T.chevronIcon},I(oe,null)),ee(I("div",{ref:u,class:R([M.menu,T.menu,n===!0||l===!1?M.hidden:null]),onMouseDown:j},c.map(function(t,s){return typeof t=="string"?I("hr",{key:s,class:M.optionSeparator}):"header"in t?I("h1",{key:s,class:M.optionHeader},t.header):I("label",{key:s,class:R([M.optionValue,t.disabled===!0?M.optionValueDisabled:null,t.disabled!==!0&&`${s}`===v?M.optionValueSelected:null])},I("input",{checked:d===t.value,class:M.input,disabled:t.disabled===!0,onChange:d===t.value?void 0:z,onClick:d===t.value?J:void 0,onMouseMove:F,tabIndex:-1,type:"radio",value:`${t.value}`,[A]:`${s}`}),t.value===d?I("div",{class:M.checkIcon},I(ne,null)):null,typeof t.text>"u"?t.value:t.text)})),document.body))});function Ie(n){if(typeof n!="string"){if("text"in n)return n.text;if("value"in n)return n.value}throw new Error("Invariant violation")}function P(n,e){if(e===null)return-1;let o=0;for(const r of n){if(typeof r!="string"&&"value"in r&&r.value===e)return o;o+=1}return-1}export{De as D};
